/*! @name videojs-playlist-ui @version 3.4.2 @license Apache-2.0 */
!function(t,e){"object"==typeof exports&&"undefined"!=typeof module?module.exports=e(require("global/document"),require("video.js")):"function"==typeof define&&define.amd?define(["global/document","video.js"],e):t.videojsPlaylistUi=e(t.document,t.videojs)}(this,function(t,e){"use strict";t=t&&t.hasOwnProperty("default")?t.default:t,e=e&&e.hasOwnProperty("default")?e.default:e;var i,l="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},a=function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")},s=function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function, not "+typeof e);t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}}),e&&(Object.setPrototypeOf?Object.setPrototypeOf(t,e):t.__proto__=e)},n=function(t,e){if(!t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!e||"object"!=typeof e&&"function"!=typeof e?t:e},r=e.dom||e,o=e.registerPlugin||e.plugin,p={className:"vjs-playlist",playOnSelect:!1,supportsCssPointerEvents:((i=t.createElement("x")).style.cssText="pointer-events:auto","auto"===i.style.pointerEvents)},c=function(t){t.addClass("vjs-selected")},u=function(t){t.removeClass("vjs-selected"),t.thumbnail&&r.removeClass(t.thumbnail,"vjs-playlist-now-playing")},d=function(t){t.removeClass("vjs-up-next")},h=e.getComponent("Component"),y=function(i){function r(t,e,l){if(a(this,r),!e.item)throw new Error("Cannot construct a PlaylistMenuItem without an item option");var s=n(this,i.call(this,t,e));return s.item=e.item,s.playOnSelect=l.playOnSelect,s.emitTapEvents(),s.on(["click","tap"],s.switchPlaylistItem_),s.on("keydown",s.handleKeyDown_),s}return s(r,i),r.prototype.handleKeyDown_=function(t){13!==t.which&&32!==t.which||this.switchPlaylistItem_()},r.prototype.switchPlaylistItem_=function(t){this.player_.playlist.currentItem(function(t,e){for(var i=0,l=t.length;i<l;i++)if(t[i]===e)return i;return-1}(this.player_.playlist(),this.item)),this.playOnSelect&&this.player_.play()},r.prototype.createEl=function(){var i=t.createElement("li"),a=this.options_.item;if("object"===l(a.data)&&a.data){var s=Object.keys(a.data);s.length>0&&s.forEach(function(t){var e=a.data[t];i.dataset[t]=e})}if(i.className="vjs-playlist-item",i.setAttribute("tabIndex",0),this.thumbnail=function(e){if(!e){var i=t.createElement("div");return i.className="vjs-playlist-thumbnail vjs-playlist-thumbnail-placeholder",i}var l=t.createElement("picture");if(l.className="vjs-playlist-thumbnail","string"==typeof e){var a=t.createElement("img");a.src=e,a.alt="",l.appendChild(a)}else{for(var s=0;s<e.length-1;s++){var n=e[s],r=t.createElement("source");for(var o in n)r[o]=n[o];l.appendChild(r)}var p=e[e.length-1],c=t.createElement("img");for(var u in c.alt="",p)c[u]=p[u];l.appendChild(c)}return l}(a.thumbnail),i.appendChild(this.thumbnail),a.duration){var n=t.createElement("time"),r=e.formatTime(a.duration);n.className="vjs-playlist-duration",n.setAttribute("datetime","PT0H0M"+a.duration+"S"),n.appendChild(t.createTextNode(r)),i.appendChild(n)}var o=t.createElement("span"),p=this.localize("Now Playing");o.className="vjs-playlist-now-playing-text",o.appendChild(t.createTextNode(p)),o.setAttribute("title",p),this.thumbnail.appendChild(o);var c=t.createElement("div");c.className="vjs-playlist-title-container",this.thumbnail.appendChild(c);var u=t.createElement("span"),d=this.localize("Up Next");u.className="vjs-up-next-text",u.appendChild(t.createTextNode(d)),u.setAttribute("title",d),c.appendChild(u);var h=t.createElement("cite"),y=a.name||this.localize("Untitled Video");return h.className="vjs-playlist-name",h.appendChild(t.createTextNode(y)),h.setAttribute("title",y),c.appendChild(h),i},r}(h),m=function(i){function l(t,s){if(a(this,l),!t.playlist)throw new Error("videojs-playlist is required for the playlist component");var r=n(this,i.call(this,t,s));return r.items=[],s.horizontal?r.addClass("vjs-playlist-horizontal"):r.addClass("vjs-playlist-vertical"),s.supportsCssPointerEvents&&r.addClass("vjs-csspointerevents"),r.createPlaylist_(),e.browser.TOUCH_ENABLED||r.addClass("vjs-mouse"),t.on(["loadstart","playlistchange","playlistsorted"],function(t){r.update()}),t.on("adstart",function(){r.addClass("vjs-ad-playing")}),t.on("adend",function(){r.removeClass("vjs-ad-playing")}),r}return s(l,i),l.prototype.createEl=function(){return r.createEl("div",{className:this.options_.className})},l.prototype.createPlaylist_=function(){var e=this.player_.playlist()||[],i=this.el_.querySelector(".vjs-playlist-item-list"),l=this.el_.querySelector(".vjs-playlist-ad-overlay");i||((i=t.createElement("ol")).className="vjs-playlist-item-list",this.el_.appendChild(i));for(var a=0;a<this.items.length;a++)i.removeChild(this.items[a].el_);this.items.length=0;for(var s=0;s<e.length;s++){var n=new y(this.player_,{item:e[s]},this.options_);this.items.push(n),i.appendChild(n.el_)}l?i.appendChild(l):((l=t.createElement("li")).className="vjs-playlist-ad-overlay",i.appendChild(l));var o=this.player_.playlist.currentItem();if(this.items.length&&o>=0){c(this.items[o]);var p=this.items[o].$(".vjs-playlist-thumbnail");p&&r.addClass(p,"vjs-playlist-now-playing")}},l.prototype.update=function(){var e=this.player_.playlist();if(this.items.length===e.length){for(var i=0;i<this.items.length;i++)if(this.items[i].item!==e[i])return void this.createPlaylist_();for(var l=this.player_.playlist.currentItem(),a=0;a<this.items.length;a++){var s=this.items[a];a===l?(c(s),t.activeElement!==s.el()&&r.addClass(s.thumbnail,"vjs-playlist-now-playing"),d(s)):a===l+1?(u(s),s.addClass("vjs-up-next")):(u(s),d(s))}}else this.createPlaylist_()},l}(h),f=function(t){for(var e=0;e<t.childNodes.length;e++)if(r.isEl(t.childNodes[e]))return!0;return!1},v=function(i){if(!this.playlist)throw new Error("videojs-playlist plugin is required by the videojs-playlist-ui plugin");if(r.isEl(i)&&(e.log.warn('videojs-playlist-ui: Passing an element directly to playlistUi() is deprecated, use the "el" option instead!'),i={el:i}),i=e.mergeOptions(p,i),this.playlistMenu){var l=this.playlistMenu.el();if(l){var a=l.parentNode,s=l.nextSibling;this.playlistMenu.dispose(),r.emptyEl(l),s?a.insertBefore(l,s):a.appendChild(l),i.el=l}}r.isEl(i.el)||(i.el=function(e){for(var i=t.querySelectorAll("."+e),l=void 0,a=0;a<i.length;a++)if(!f(i[a])){l=i[a];break}return l}(i.className)),this.playlistMenu=new m(this,i)};return e.registerComponent("PlaylistMenu",m),e.registerComponent("PlaylistMenuItem",y),o("playlistUi",v),v.VERSION="3.4.2",v});
